<!DOCTYPE html>
<html lang="en">

<head>
    <title>Pbo Beleg</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Include own CSS Style-->
    <link rel="stylesheet" href="style.css">


    <!-- Include Bootstrap -->
    <link rel="stylesheet" href="3rd/bootstrap.min.css">
    <script src="3rd/jquery-3.3.1.min.js"></script>
    <script src="3rd/popper.min.js"></script>
    <script src="3rd/bootstrap.min.js"></script>

    <!-- Include D3 -->
    <script src="3rd/d3.v5.min.js"></script>

    <!-- Include own js -->
    <!--<script src="data/testdata.js"></script>-->
    <script src="data_handler.js"></script>
    <script src="lib/diagram.js"></script>
</head>

<body>
    <div class="container jumbotron" style="text-align:center">
        <h1>PBo Beleg</h1>
    </div>
    <div class="container" style="text-align:center">
        <div>
            <svg id="diagram1"></svg>
        </div>
        <div>
            <button onclick="animationLoop()">Play</button>
            <button onclick="clearTimeout(animationTimeout)">Stop</button>
            2000<input type="range" id="year" min="2000" max="2016" value="2000" onchange="update()">2016
        </div>
        <script>
            // load given fao data


            var animationTimeout;
            const data = loadData();

            var minMax =  getMinMax(data,"polit");
            console.log("Min: " + minMax[0] + " Max: " + minMax[1]);
            setPolitDomain(minMax[0],minMax[1]);

            minMax =  getMinMax(data,"bip");
            console.log("Min: " + minMax[0] + " Max: " + minMax[1]);
            setBipDomain(minMax[0],minMax[1]);
            
            minMax =  getMinMax(data,"fat");
            console.log("Min: " + minMax[0] + " Max: " + minMax[1]);
            setFatDomain(minMax[0],minMax[1]);

            // Initialize Diagram with Year 2000
            generateDiagram(data["2000"], "diagram1");

            // If user changes the year -or- clicks the play button
            // the following function triggers the Diagram update
            function update() {
                var year = Number($('#year').val())
                updateDiagram(data[String(year)], "diagram1");
            }

            // If the user clicks on the play button
            // animationLoop starts and continous the animation
            // by updating the slider and calling the update function
            function animationLoop() {
                var slider = $('#year')
                var year = Number(slider.val());
                if (year == 2016)
                    return;

                slider.val(year + 1);

                update();
                animationTimeout = setTimeout(animationLoop, 1200);

            }
        </script>
</body>

</html>